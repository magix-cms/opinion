+function($){"use strict";function setInput(id){$.jmRequest({handler:"ajax",url:"/"+baseadmin+"/index.php?controller=opinion&action=edit&edit="+id,method:"get",dataType:"json",success:function(d){if(d!==undefined){$("#id_opinion").val(d.id_opinion);$("#name").text(d.pseudo_opinion);$("#email").text(d.email_opinion);$("#msg_opinion").val(d.msg_opinion);$("#filled-star").attr("data-rate",d.rating_opinion)}}})}function save(id){var msg="";$("#forms-plugins-comment").validate({onsubmit:true,event:"submit",rules:{msg_opinion:{required:true},id:{required:true}},submitHandler:function(f){$.jmRequest({handler:"submit",url:"/"+baseadmin+"/index.php?controller=opinion&action=edit",method:"post",form:$(f),resetForm:true,beforeSend:function(){msg=$("#msg_opinion").val()},successParams:function(d){$.jmRequest.initbox(d.notify,{display:true});$("#op_"+d.result["id"]).find(".op_content > a").popover("destroy").attr("data-content",msg).data("content",msg).popover();$("#modal-edit").modal("hide")}});return false}})}function delete_data(id){$("#delete_form").validate({ignore:[],onsubmit:true,event:"submit",rules:{id:{required:true}},submitHandler:function(){$.jmRequest({handler:"submit",url:"/"+baseadmin+"/index.php?controller=opinion&action=delete",method:"post",form:$("#delete_form"),resetForm:true,success:function(d){$("#modal-delete").modal("hide");$.jmRequest.initbox(d.notify,{display:true});window.setTimeout(function(){$(".mc-message .alert").alert("close")},4e3);if(d.statut&&d.result){$("#op_"+d.result["id"]).remove()}}})}})}function validate(id){$("#validate_form").validate({ignore:[],onsubmit:true,event:"submit",rules:{id:{required:true}},submitHandler:function(){$.jmRequest({handler:"submit",url:"/"+baseadmin+"/index.php?controller=opinion&action=validate",method:"post",form:$("#validate_form"),resetForm:true,success:function(d){$("#modal-validate").modal("hide");$.jmRequest.initbox(d.notify,{display:true});window.setTimeout(function(){$(".mc-message .alert").alert("close")},4e3);if(d.statut&&d.result){$("#op_"+d.result["id"]).remove()}}})}})}$(window).on("load",function(){$('[data-toggle="popover"]').popover();if(typeof baseadmin!=="undefined"){$(document).on("click","a.toggleModal",function(){if($(this).data("id")){var id=$(this).data("id");if($(this).data("target")=="#modal-edit"){$("#forms-plugins-comment")[0].reset();setInput(id);save(id)}else if($(this).data("target")=="#modal-validate"){$('#validate_form input[name="id"]').val(id);validate(id)}else{$('#delete_form input[name="id"]').val(id);delete_data(id)}}})}})}(jQuery);